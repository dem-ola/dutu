!function(e){var t={};function a(s){if(t[s])return t[s].exports;var i=t[s]={i:s,l:!1,exports:{}};return e[s].call(i.exports,i,i.exports,a),i.l=!0,i.exports}a.m=e,a.c=t,a.d=function(e,t,s){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(a.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)a.d(s,i,function(t){return e[t]}.bind(null,i));return s},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=0)}([function(e,t,a){"use strict";a.r(t);const s={primary:"dutu",archive:"archive"};function i(e){let t=localStorage.getItem(e+"JSON");if(null==(t=null==t||"undefined"==t?null:t))return t;(t=JSON.parse(t)).listorder=-1;let a=t.tasks;for(let e in a)a[e].hasOwnProperty("category")||(a[e].category=defaultCategory),""==a[e].category.trim()&&(a[e].category=defaultCategory),-1==t.categories.indexOf(a[e].category)&&t.categories.push(a[e].category),t.categories=t.categories.filter(e=>""!=e.trim()),a[e].done||(a[e].order=++t.listorder);for(let e in a)a[e].done&&(a[e].order=++t.listorder);return t}function n(e,t,a){let s=t.tasks;for(let e in s)"string"!=typeof s[e].category&&(s[e].category=a);localStorage.setItem(e+"JSON",JSON.stringify(t))}const l="0.15a",r=s.primary;s.archive;let d=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var o,c="General";function h(e,t,a){let s,i=e.className;s="add"==a?i+" "+t:i.replace(t,""),e.setAttribute("class",s)}function p(e){let t=e.match(/(\d+)-(.*?)-(\d+)/);return new Date(t[3],d.indexOf(t[2]),t[1])}function m(e){return e.getDate()+"-"+d[e.getMonth()]+"-"+e.getFullYear()}function u(e,t=null){if(null==e||null==e)return"0d";let a=new Date;null!=t&&(a=p(t));let s=p(e);return parseInt((a-s)/864e5)+"d"}null==(o=i(r))&&(n(r,o={me:"My",categories:["All","General"],tasks:{},restack:!1},c),i(r)),String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)};const g=e=>React.createElement("input",{type:"text",id:e.id,className:e.className,placeholder:e.place,disabled:e.disabled,defaultValue:e.value,onChange:e.handle}),f=e=>React.createElement("textarea",{type:"text",id:e.id,className:e.className,placeholder:e.placeholder,maxLength:e.maxlength,defaultValue:e.value}),b=e=>React.createElement("button",{id:e.id,className:e.className,onClick:e.handle,disabled:e.disabled},e.txt),y=e=>1==e.checked||"true"==e.checked?React.createElement("span",null,React.createElement("label",{className:e.classNameLabel},"Done =>"),React.createElement("input",{className:e.className,type:"checkbox",checked:!0,onChange:e.handle})):React.createElement("span",null,React.createElement("label",{className:e.classNameLabel},"Done =>"),React.createElement("input",{className:e.className,type:"checkbox",checked:!1,onChange:e.handle}));class k extends React.Component{constructor(e){super(e),this.handleChange=this.handleChange.bind(this),this.state={}}componentDidMount(){this.setState({value:this.props.categories[0]}),this.props.todoitem&&null!=this.props.task.category&&this.setState({value:this.props.task.category})}handleChange(e){this.setState({value:e.target.value}),this.props.onChange()}render(){let e=[],t=this.props.categories.length;for(let a=0;a<t;a++)e.push(React.createElement("option",{key:a,value:this.props.categories[a]},this.props.categories[a]));return React.createElement("select",{id:this.props.id,className:this.props.className,value:this.state.value,onChange:this.handleChange},e)}}class v extends React.Component{constructor(e){super(e),this.handleEdit=this.handleEdit.bind(this),this.handleDone=this.handleDone.bind(this),this.handleChangeCat=this.handleChangeCat.bind(this),this.handleNotesOpen=this.handleNotesOpen.bind(this),this.handleNotesSave=this.handleNotesSave.bind(this),this.state={item:e.taskie,todo:e.taskie.task,notes:e.taskie.notes,notesPlaceholder:"Write here",key:e.objKey,confirm:"Confirm",edit:"Edit",editing:!1,added:e.taskie.added,finished:e.taskie.finished,done:e.taskie.done,categories:e.data.categories,pending:u(e.taskie.added,e.taskie.finished),catId:"item-category-"+e.objKey}}handleDone(e){let t=e.target.parentElement.parentElement,a=t.querySelector(".item-todo"),s=t.querySelector(".item-edit"),i=this.state.finished;if(e.target.checked)h(a,"item-todo-done","add"),s.setAttribute("disabled",!0),null!=i&&null!=i||(i=m(new Date),this.setState({finished:i})),this.setState({done:!0}),this.props.data.tasks[this.state.key].done=!0;else{if(h(a,"item-todo-done","remove"),s.removeAttribute("disabled"),null!=i&&null!=i){confirm("Keep the old finished date?")||(i=null,this.setState({finished:i}))}this.setState({done:!1}),this.props.data.tasks[this.state.key].done=!1}this.props.data.tasks[this.state.key].finished=i,n(r,this.props.data,c)}handleEdit(e){let t=e.target.parentElement.querySelector(".item-todo"),a=e.target;if(a.textContent=this.state.confirm,this.state.editing){if(t.value!=this.state.todo){confirm("Save this edit?")?(this.setState({todo:t.value}),this.props.data.tasks[this.state.key].task=t.value,n(r,this.props.data,c)):t.value=this.state.todo}t.setAttribute("disabled",!0),a.textContent=this.state.edit,h(a,"item-confirm-highlight","remove"),h(t,"todo-editing","remove"),this.setState({editing:!1})}else t.removeAttribute("disabled"),t.focus(),h(e.target,"item-confirm-highlight","add"),h(t,"todo-editing","add"),this.setState({editing:!0})}handleNotesOpen(e){let t=e.target.parentElement,a=t.querySelector(".item-notes-wrap"),s=t.querySelector(".item-notes");-1==e.target.className.indexOf("item-notes-opened")?(e.target.textContent="Close",h(e.target,"item-notes-opened","add"),h(a,"item-notes-selected","add")):(e.target.textContent="Notes",s.value=this.state.notes||this.state.notesPlaceholder,h(e.target,"item-notes-opened","remove"),h(a,"item-notes-selected","remove"))}handleNotesSave(e){let t=e.target.parentElement.parentElement;t.querySelector(".item-notes-btn-open").textContent="Notes";let a=t.querySelector(".item-notes").value;this.setState({notes:a}),this.props.data.tasks[this.state.key].notes=a,n(r,this.props.data,c),h(t.querySelector(".item-notes-wrap"),"item-notes-selected","remove")}handleChangeCat(){let e=this.state.catId;this.props.data.tasks[this.state.key].category=document.querySelector("#"+e).value,n(r,this.props.data,c)}render(){let e="item-todo",t=!1,a="";1!=this.state.done&&"true"!=this.state.done||(e="item-todo item-todo-done",t=!0),null!=this.state.finished&&(a="fin.");let s=this.props.data.categories.slice(1);return React.createElement("div",{id:this.props.id,className:this.props.cname},React.createElement("span",{className:"item-id"},this.props.id.match(/\d+/)[0]),React.createElement("span",{className:"item-obj-key"},this.props.objKey),React.createElement("div",{className:"item-todo-box"},React.createElement(g,{className:e,disabled:!0,value:this.state.todo,done:this.state.done}),React.createElement(b,{className:"item-notes-btn item-notes-btn-open",txt:"Notes",handle:this.handleNotesOpen,disabled:t}),React.createElement("div",{className:"item-notes-wrap"},React.createElement(f,{className:"item-notes",maxlength:"500",placeholder:this.state.notesPlaceholder,value:this.state.notes}),React.createElement(b,{className:"item-notes-btn item-notes-btn-save",txt:"Save",handle:this.handleNotesSave}))),React.createElement(k,{id:this.state.catId,className:"item-category",categories:s,todoitem:!0,task:this.props.data.tasks[this.state.key],data:this.props.data,onChange:this.handleChangeCat}),React.createElement(b,{className:"item-edit",txt:"Edit",handle:this.handleEdit,disabled:t}),React.createElement(b,{className:"item-delete",txt:"Delete",handle:this.props.handleDelete}),React.createElement(y,{className:"item-done",classNameLabel:"item-done-label",handle:this.handleDone,checked:this.state.done}),React.createElement("span",{className:"item-date"},React.createElement("span",{className:"item-date-prefix"},"add. "),this.state.added),React.createElement("span",{className:"item-date"},React.createElement("span",{className:"item-date-prefix"},a," "),this.state.finished),React.createElement("span",{className:"item-pending"},"=> ",this.state.pending))}}const E=e=>{let t=e.data.tasks,a=Object.keys(t),s=[],i={},n=e.data.restack;for(let e=0;e<a.length;e++){let s=a[e];i[t[s].order]=s}for(let l=0;l<a.length;l++){let r=n?i[l]:a[l];if(null!=e.selected&&"All"!=e.selected){if((null==t[r].category?c:t[r].category)!=e.selected)continue}s.push(React.createElement(v,{key:l,id:"row-"+(parseInt(l)+1),cname:"item-row",objKey:r,data:e.data,taskie:t[r],handleDelete:e.handleDelete}))}return React.createElement("div",null,s)};class R extends React.Component{constructor(e){super(e),this.handleAdd=this.handleAdd.bind(this),this.handleClear=this.handleClear.bind(this),this.handleDelete=this.handleDelete.bind(this),this.handleEditCat=this.handleEditCat.bind(this),this.handleFilterCat=this.handleFilterCat.bind(this),this.handleRestack=this.handleRestack.bind(this),this.handleArchive=this.handleArchive.bind(this),this.handleUnArchive=this.handleUnArchive.bind(this),this.state={theList:React.createElement(E,{data:this.props.data,handleDelete:this.handleDelete}),keys:Object.keys(e.data.tasks),listorder:this.props.data.listorder,restack:this.props.data.restack,stackText:this.props.data.restack?"Unstack":"Restack"}}componentDidUpdate(e){this.props!==e&&this.setState({restack:this.props.data.restack,theList:React.createElement(E,{data:this.props.data,handleDelete:this.handleDelete})})}handleAdd(e){let t=document.querySelector("#item-box");if(""==t.value.trim())return;this.setState({prevProps:this.props.data.tasks});let a=m(new Date),s={task:t.value,added:a,order:++this.state.listorder},i=this.state.keys,l=0;i.length>0&&(l=i.reduce((e,t)=>Math.max(e,t))+1),this.props.data.tasks[l]=s,n(r,this.props.data,c),i.push(l),this.setState({keys:i,listorder:++this.state.listorder}),this.componentDidUpdate(),t.value=""}handleClear(e){if(0==Object.keys(this.props.data.tasks).length)return;confirm("Clear your entire list\nWarning: This action cannot be reversed")&&(this.props.data.tasks={},n(r,this.props.data,c),this.componentDidUpdate())}handleEditCat(){let e=this.props.data.categories.slice(0,2),t=this.props.data.categories.slice(2);t=t.join(", ");let a=prompt("Create a new category. Separate multiples with commas.\n\nIf you rename an existing Category\nyou will have to re-categorise affected items",t);if(a!=t){let t=a.split(",");t=t.map(e=>e.trim().capitalize()),t=e.concat(t);let s=this.props.data.tasks;for(let e in s)-1==t.indexOf(s[e].category)&&(s[e].category=c);this.props.data.categories=t,n(r,this.props.data,c)}this.componentDidUpdate()}handleFilterCat(){let e=document.querySelector("#cat-filter").value;this.setState({theList:React.createElement(E,{data:this.props.data,selected:e,handleDelete:this.handleDelete})})}handleDelete(e){let t=e.target.parentElement.querySelector(".item-obj-key").textContent;confirm("Delete this task?")&&(delete this.props.data.tasks[t],n(r,this.props.data,c)),this.componentDidUpdate()}handleRestack(e){this.state.restack?(this.props.data.restack=!1,e.target.textContent="Restack"):(this.props.data.restack=!0,e.target.textContent="Unstack"),n(r,this.props.data,c),this.componentDidUpdate(),location.reload()}handleArchive(e){n(r,this.props.data,c),this.componentDidUpdate(),location.reload()}handleUnArchive(e){n(r,this.props.data,c),this.componentDidUpdate(),location.reload()}render(){return React.createElement("div",null,React.createElement("div",{id:"above"},React.createElement(g,{id:"item-box",place:"Add new todo item"}),React.createElement(b,{id:"add-new",className:"above-btn",txt:"Add New",handle:this.handleAdd}),React.createElement(b,{id:"clear-list",className:"above-btn",txt:"Clear List",handle:this.handleClear}),React.createElement(b,{id:"cat-edit",className:"above-btn",txt:"Edit Categories",handle:this.handleEditCat}),React.createElement("span",{id:"cat-filter-label"},"Filter:"),React.createElement(k,{id:"cat-filter",categories:this.props.data.categories,onChange:this.handleFilterCat}),React.createElement(b,{id:"restack",className:"above-btn",txt:this.state.stackText,handle:this.handleRestack})),this.state.theList)}}class N extends React.Component{render(){return React.createElement("div",null,React.createElement("div",{id:"app-name"},"Dutu",React.createElement("span",{id:"version"},l),React.createElement("span",{id:"app-byline"},"the todo app for big plans")),React.createElement("div",{id:"me"}," ",this.props.data.me," Todo List "),React.createElement("div",{id:"table"},React.createElement(R,{data:this.props.data})))}}ReactDOM.render(React.createElement(N,{data:o}),document.getElementById("root"))}]);