!function(e){var t={};function a(s){if(t[s])return t[s].exports;var n=t[s]={i:s,l:!1,exports:{}};return e[s].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=t,a.d=function(e,t,s){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(a.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)a.d(s,n,function(t){return e[t]}.bind(null,n));return s},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=0)}([function(e,t,a){"use strict";a.r(t);const s={primary:"dutu",archive:"dutu-archive"},n="General";var i=["All","General"],l=n;function r(){return{me:"My",categories:i,tasks:{},restack:!1}}function d(e){let t=localStorage.getItem(e+"JSON");if(null==(t=null==t||"undefined"==t?null:t))return t;(t=JSON.parse(t)).listorder=-1;let a=t.tasks;for(let e in a)a[e].hasOwnProperty("category")||(a[e].category=l),""==a[e].category.trim()&&(a[e].category=l),-1==t.categories.indexOf(a[e].category)&&t.categories.push(a[e].category),t.categories=t.categories.filter(e=>""!=e.trim()),a[e].done||(a[e].order=++t.listorder);for(let e in a)a[e].done&&(a[e].order=++t.listorder);return t}function o(e,t,a){let s=t.tasks;for(let e in s)"string"!=typeof s[e].category&&(s[e].category=a);localStorage.setItem(e+"JSON",JSON.stringify(t))}const c="0.15",h=s.primary,p=s.archive,m=n;let u=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var g;function f(e,t,a){let s,n=e.className;s="add"==a?n+" "+t:n.replace(t,""),e.setAttribute("class",s)}function b(e){let t=e.match(/(\d+)-(.*?)-(\d+)/);return new Date(t[3],u.indexOf(t[2]),t[1])}function k(e){return e.getDate()+"-"+u[e.getMonth()]+"-"+e.getFullYear()}function v(e,t=null){if(null==e||null==e)return"0d";let a=new Date;null!=t&&(a=b(t));let s=b(e);return parseInt((a-s)/864e5)+"d"}null==(g=d(h))&&(g=r(),o(h,g,m),g=d(h)),String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)};const y=e=>React.createElement("input",{type:"text",id:e.id,className:e.className,placeholder:e.place,disabled:e.disabled,defaultValue:e.value,onChange:e.handle}),E=e=>React.createElement("textarea",{type:"text",id:e.id,className:e.className,placeholder:e.placeholder,maxLength:e.maxlength,defaultValue:e.value}),R=e=>React.createElement("button",{id:e.id,className:e.className,onClick:e.handle,disabled:e.disabled},e.txt),N=e=>1==e.checked||"true"==e.checked?React.createElement("span",null,React.createElement("label",{className:e.classNameLabel},"Done =>"),React.createElement("input",{className:e.className,type:"checkbox",checked:!0,onChange:e.handle})):React.createElement("span",null,React.createElement("label",{className:e.classNameLabel},"Done =>"),React.createElement("input",{className:e.className,type:"checkbox",checked:!1,onChange:e.handle}));class C extends React.Component{constructor(e){super(e),this.handleChange=this.handleChange.bind(this),this.state={}}componentDidMount(){this.setState({value:this.props.categories[0]}),this.props.todoitem&&null!=this.props.task.category&&this.setState({value:this.props.task.category})}handleChange(e){this.setState({value:e.target.value}),this.props.onChange()}render(){let e=[],t=this.props.categories.length;for(let a=0;a<t;a++)e.push(React.createElement("option",{key:a,value:this.props.categories[a]},this.props.categories[a]));return React.createElement("select",{id:this.props.id,className:this.props.className,value:this.state.value,onChange:this.handleChange},e)}}class x extends React.Component{constructor(e){super(e),this.handleEdit=this.handleEdit.bind(this),this.handleDone=this.handleDone.bind(this),this.handleChangeCat=this.handleChangeCat.bind(this),this.handleNotesOpen=this.handleNotesOpen.bind(this),this.handleNotesSave=this.handleNotesSave.bind(this),this.state={item:e.taskie,todo:e.taskie.task,notes:e.taskie.notes,notesPlaceholder:"Write here",key:e.objKey,confirm:"Confirm",edit:"Edit",editing:!1,added:e.taskie.added,finished:e.taskie.finished,done:e.taskie.done,categories:e.data.categories,pending:v(e.taskie.added,e.taskie.finished),catId:"item-category-"+e.objKey}}handleDone(e){let t=e.target.parentElement.parentElement,a=t.querySelector(".item-todo"),s=t.querySelector(".item-edit"),n=this.state.finished;if(e.target.checked)f(a,"item-todo-done","add"),s.setAttribute("disabled",!0),null!=n&&null!=n||(n=k(new Date),this.setState({finished:n})),this.setState({done:!0}),this.props.data.tasks[this.state.key].done=!0;else{if(f(a,"item-todo-done","remove"),s.removeAttribute("disabled"),null!=n&&null!=n){confirm("Keep the old finished date?")||(n=null,this.setState({finished:n}))}this.setState({done:!1}),this.props.data.tasks[this.state.key].done=!1}this.props.data.tasks[this.state.key].finished=n,o(h,this.props.data,m)}handleEdit(e){let t=e.target.parentElement.querySelector(".item-todo"),a=e.target;if(a.textContent=this.state.confirm,this.state.editing){if(t.value!=this.state.todo){confirm("Save this edit?")?(this.setState({todo:t.value}),this.props.data.tasks[this.state.key].task=t.value,o(h,this.props.data,m)):t.value=this.state.todo}t.setAttribute("disabled",!0),a.textContent=this.state.edit,f(a,"item-confirm-highlight","remove"),f(t,"todo-editing","remove"),this.setState({editing:!1})}else t.removeAttribute("disabled"),t.focus(),f(e.target,"item-confirm-highlight","add"),f(t,"todo-editing","add"),this.setState({editing:!0})}handleNotesOpen(e){let t=e.target.parentElement,a=t.querySelector(".item-notes-wrap"),s=t.querySelector(".item-notes");-1==e.target.className.indexOf("item-notes-opened")?(e.target.textContent="Close",f(e.target,"item-notes-opened","add"),f(a,"item-notes-selected","add")):(e.target.textContent="Notes",s.value=this.state.notes||this.state.notesPlaceholder,f(e.target,"item-notes-opened","remove"),f(a,"item-notes-selected","remove"))}handleNotesSave(e){let t=e.target.parentElement.parentElement;t.querySelector(".item-notes-btn-open").textContent="Notes";let a=t.querySelector(".item-notes").value;this.setState({notes:a}),this.props.data.tasks[this.state.key].notes=a,o(h,this.props.data,m),f(t.querySelector(".item-notes-wrap"),"item-notes-selected","remove")}handleChangeCat(){let e=this.state.catId;this.props.data.tasks[this.state.key].category=document.querySelector("#"+e).value,o(h,this.props.data,m)}render(){let e="item-todo",t=!1,a="";1!=this.state.done&&"true"!=this.state.done||(e="item-todo item-todo-done",t=!0),null!=this.state.finished&&(a="fin.");let s=this.props.data.categories.slice(1);return React.createElement("div",{id:this.props.id,className:this.props.cname},React.createElement("span",{className:"item-id"},this.props.id.match(/\d+/)[0]),React.createElement("span",{className:"item-obj-key"},this.props.objKey),React.createElement("div",{className:"item-todo-box"},React.createElement(y,{className:e,disabled:!0,value:this.state.todo,done:this.state.done}),React.createElement(R,{className:"item-notes-btn item-notes-btn-open",txt:"Notes",handle:this.handleNotesOpen,disabled:t}),React.createElement("div",{className:"item-notes-wrap"},React.createElement(E,{className:"item-notes",maxlength:"500",placeholder:this.state.notesPlaceholder,value:this.state.notes}),React.createElement(R,{className:"item-notes-btn item-notes-btn-save",txt:"Save",handle:this.handleNotesSave}))),React.createElement(C,{id:this.state.catId,className:"item-category",categories:s,todoitem:!0,task:this.props.data.tasks[this.state.key],data:this.props.data,onChange:this.handleChangeCat}),React.createElement(R,{className:"item-edit",txt:"Edit",handle:this.handleEdit,disabled:t}),React.createElement(R,{className:"item-delete",txt:"Delete",handle:this.props.handleDelete}),React.createElement(N,{className:"item-done",classNameLabel:"item-done-label",handle:this.handleDone,checked:this.state.done}),React.createElement("span",{className:"item-date"},React.createElement("span",{className:"item-date-prefix"},"add. "),this.state.added),React.createElement("span",{className:"item-date"},React.createElement("span",{className:"item-date-prefix"},a," "),this.state.finished),React.createElement("span",{className:"item-pending"},"=> ",this.state.pending))}}const S=e=>{let t=e.data.tasks,a=Object.keys(t),s=[],n={},i=e.data.restack;for(let e=0;e<a.length;e++){let s=a[e];n[t[s].order]=s}for(let l=0;l<a.length;l++){let r=i?n[l]:a[l];if(null!=e.selected&&"All"!=e.selected){if((null==t[r].category?m:t[r].category)!=e.selected)continue}s.push(React.createElement(x,{key:l,id:"row-"+(parseInt(l)+1),cname:"item-row",objKey:r,data:e.data,taskie:t[r],handleDelete:e.handleDelete}))}return React.createElement("div",null,s)};class D extends React.Component{constructor(e){super(e),this.handleAdd=this.handleAdd.bind(this),this.handleClear=this.handleClear.bind(this),this.handleDelete=this.handleDelete.bind(this),this.handleEditCat=this.handleEditCat.bind(this),this.handleFilterCat=this.handleFilterCat.bind(this),this.handleRestack=this.handleRestack.bind(this),this.handleArchive=this.handleArchive.bind(this),this.handleUnArchive=this.handleUnArchive.bind(this),this.state={theList:React.createElement(S,{data:this.props.data,handleDelete:this.handleDelete}),keys:Object.keys(e.data.tasks),listorder:this.props.data.listorder,restack:this.props.data.restack,stackText:this.props.data.restack?"Unstack":"Restack"}}componentDidUpdate(e){this.props!==e&&this.setState({restack:this.props.data.restack,theList:React.createElement(S,{data:this.props.data,handleDelete:this.handleDelete})})}handleAdd(e){let t=document.querySelector("#item-box");if(""==t.value.trim())return;this.setState({prevProps:this.props.data.tasks});let a=k(new Date),s={task:t.value,added:a,order:++this.state.listorder},n=this.state.keys,i=0;n.length>0&&(i=n.reduce((e,t)=>Math.max(e,t))+1),this.props.data.tasks[i]=s,o(h,this.props.data,m),n.push(i),this.setState({keys:n,listorder:this.state.listorder}),this.componentDidUpdate(),t.value=""}handleClear(e){if(0==Object.keys(this.props.data.tasks).length)return;confirm("Clear your entire list\nWarning: This action cannot be reversed")&&(this.props.data.tasks={},o(h,this.props.data,m),this.componentDidUpdate())}handleEditCat(){let e=this.props.data.categories.slice(0,2),t=this.props.data.categories.slice(2);t=t.join(", ");let a=prompt("Create a new category. Separate multiples with commas.\n\nIf you rename an existing Category\nyou will have to re-categorise affected items",t);if(a!=t){let t=a.split(",");t=t.map(e=>e.trim().capitalize()),t=e.concat(t);let s=this.props.data.tasks;for(let e in s)-1==t.indexOf(s[e].category)&&(s[e].category=m);this.props.data.categories=t,o(h,this.props.data,m)}this.componentDidUpdate()}handleFilterCat(){let e=document.querySelector("#cat-filter").value;this.setState({theList:React.createElement(S,{data:this.props.data,selected:e,handleDelete:this.handleDelete})})}handleDelete(e){let t=e.target.parentElement.querySelector(".item-obj-key").textContent;confirm("Delete this task?")&&(delete this.props.data.tasks[t],o(h,this.props.data,m)),this.componentDidUpdate()}handleRestack(e){this.state.restack?(this.props.data.restack=!1,e.target.textContent="Restack"):(this.props.data.restack=!0,e.target.textContent="Unstack"),o(h,this.props.data,m),this.componentDidUpdate(),location.reload()}handleArchive(e){(function(e,t,a){let s=!1,n=d(e),i=d(t);i||(i=r());let l=n.tasks,c=i.tasks;for(let e in l){let t=l[e];t.done&&(s=!0,c.hasOwnProperty(e)||(c[e]=t),delete l[e])}return o(e,n,a),o(t,i,a),s})(h,p,m)&&location.reload()}handleUnArchive(e){(function(e,t,a){let s=!1,n=d(t);if(!n)return!1;let i=d(e),l=i.tasks,r=n.tasks;for(let e in r)l.hasOwnProperty(e)||(s=!0,l[e]=r[e]);return o(e,i,a),o(t,n,a),s})(h,p,m)&&location.reload()}render(){return React.createElement("div",null,React.createElement("div",{id:"above"},React.createElement(y,{id:"item-box",place:"Add new todo item"}),React.createElement(R,{id:"add-new",className:"above-btn",txt:"Add New",handle:this.handleAdd}),React.createElement(R,{id:"clear-list",className:"above-btn",txt:"Clear List",handle:this.handleClear}),React.createElement(R,{id:"cat-edit",className:"above-btn",txt:"Edit Categories",handle:this.handleEditCat}),React.createElement("span",{id:"cat-filter-label"},"Filter:"),React.createElement(C,{id:"cat-filter",categories:this.props.data.categories,onChange:this.handleFilterCat}),React.createElement(R,{id:"restack",className:"above-btn",txt:this.state.stackText,handle:this.handleRestack}),React.createElement(R,{id:"archive",className:"above-btn",txt:"Archive",handle:this.handleArchive}),React.createElement(R,{id:"unarchive",className:"above-btn",txt:"Unarchive",handle:this.handleUnArchive})),this.state.theList)}}class O extends React.Component{render(){return React.createElement("div",null,React.createElement("div",{id:"app-name"},"Dutu",React.createElement("span",{id:"version"},c),React.createElement("span",{id:"app-byline"},"the todo app for big plans")),React.createElement("div",{id:"me"}," ",this.props.data.me," Todo List "),React.createElement("div",{id:"table"},React.createElement(D,{data:this.props.data})))}}ReactDOM.render(React.createElement(O,{data:g}),document.getElementById("root"))}]);